!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.CKEditor5=t():(e.CKEditor5=e.CKEditor5||{},e.CKEditor5.demoLink=t())}(self,(()=>(()=>{var e={"ckeditor5/src/core.js":(e,t,o)=>{e.exports=o("dll-reference CKEditor5.dll")("./src/core.js")},"ckeditor5/src/ui.js":(e,t,o)=>{e.exports=o("dll-reference CKEditor5.dll")("./src/ui.js")},"dll-reference CKEditor5.dll":e=>{"use strict";e.exports=CKEditor5.dll}},t={};function o(i){var n=t[i];if(void 0!==n)return n.exports;var r=t[i]={exports:{}};return e[i](r,r.exports,o),r.exports}o.d=(e,t)=>{for(var i in t)o.o(t,i)&&!o.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var i={};return(()=>{"use strict";o.d(i,{default:()=>a});var e=o("ckeditor5/src/core.js");function t(e,t){const o=e.getSelectedElement();return o&&o.name==t?o:e.getFirstRange().getCommonAncestor().findAncestor(t)}class n extends e.Command{refresh(){this.isEnabled=!0,this.value=null;const e=t(this.editor.model.document.selection,"demoLink");if(e){this.value={};for(const[t,o]of e.getAttributes())this.value[t]=o;for(const t of e.getChildren()){const e=t.getChild(0),o=e&&e._data;this.value[t.name]=o?e._data:""}}}execute(e){const{model:o}=this.editor;o.change((i=>{var n=!1,r=t(o.document.selection,"demoLink");r||(r=i.createElement("demoLink"),n=!0),this._editElement(i,r,e),n&&o.insertContent(r)}))}_editElement(e,t,o){e.clearAttributes(t);var i={};i.demoLinkUrl=o.demoLinkUrl,i.demoTextColor=o.demoTextColor,i.demoBackgroundColor=o.demoBackgroundColor,i.demoLinkClass="demo-link",e.setAttributes(i,t);const n=[];Array.from(t.getChildren()).forEach((e=>{n.push(e.name)}));const r=this._processChildTextEl(e,o,n,t,"demoLinkText");r&&e.append(r,t)}_processChildTextEl(e,t,o,i,n){const r=this._processChildElement(e,t[n],o,i,n);if(r){const o=r.getChild(0);return o&&e.remove(o),e.appendText(t[n],r),r}return null}_processChildElement(e,t,o,i,n){const r=t&&!o.includes(n),l=t&&o.includes(n),s=!t&&o.includes(n);var d=null;if(r)d=e.createElement(n);else if(l||s){let e=[];Array.from(i.getChildren()).forEach((t=>{e.push(t.name)}));var c=e.indexOf(n);d=i.getChild(c)}return o.includes(n)&&d&&e.remove(d),s?null:d}}class r extends e.Plugin{init(){this._defineSchema(),this._defineConverters(),this.editor.commands.add("demoLink",new n(this.editor))}_defineSchema(){const e=this.editor.model.schema;e.register("demoLink",{inheritAllFrom:"$inlineObject",allowAttributes:["demoLinkUrl","demoBackgroundColor","demoTextColor","demoLinkClass"],allowChildren:["demoLinkText"]}),e.register("demoLinkText",{allowIn:"demoLink",isLimit:!0,allowContentOf:"$block"})}_defineConverters(){const{conversion:e}=this.editor;e.for("upcast").elementToElement({view:{name:"a",styles:{color:!0,"background-color":!0}},model:(e,{writer:t})=>{const o=e.getAttribute("class");if(!o)return null;if(!o.split(" ").includes("demo-link"))return null;const i={demoLinkUrl:e.getAttribute("href"),demoBackgroundColor:e.getStyle("background-color"),demoTextColor:e.getStyle("color")};return t.createElement("demoLink",i)}}),e.for("downcast").elementToElement({model:"demoLink",view:(e,{writer:t})=>{const o={class:"demo-link",href:e.getAttribute("demoLinkUrl"),style:`background-color: ${e.getAttribute("demoBackgroundColor")}; color: ${e.getAttribute("demoTextColor")};`};return t.createContainerElement("a",o)}}),e.for("upcast").attributeToAttribute({view:{name:"a",styles:{color:!0},attributes:{href:!0}},model:{key:"demoLinkUrl",value:e=>({demoLinkUrl:e.getAttribute("href"),demoTextColor:e.getStyle("color")})}}),e.for("upcast").attributeToAttribute({view:{name:"a",attributes:{class:!0}},model:{key:"demoLinkClass",value:e=>e.getAttribute("class")}}),e.for("upcast").elementToElement({view:{name:"span",classes:"text"},model:(e,{writer:t})=>t.createElement("demoLinkText")}),e.for("downcast").elementToElement({model:"demoLinkText",view:(e,{writer:t})=>t.createContainerElement("span",{class:"text"})})}}var l=o("ckeditor5/src/ui.js");class s extends l.View{constructor(t){super(t),this.textInputView=this._createInput("Text",{required:!0}),this.backgroundColor=this._createInput("Background",{type:"color"}),this.textInputColor=this._createInput("Text Color",{type:"color"}),this.urlInputView=this._createInput("URL",{required:!0}),this.saveButtonView=this._createButton("Save",e.icons.check,"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton("Cancel",e.icons.cancel,"ck-button-cancel"),this.cancelButtonView.delegate("execute").to(this,"cancel"),this.childViewsCollection=this.createCollection([this.textInputView,this.backgroundColor,this.textInputColor,this.urlInputView,this.saveButtonView,this.cancelButtonView]),this.setTemplate({tag:"form",attributes:{class:["ck","ck-demo-link-form"],tabindex:"-1"},children:this.childViewsCollection})}render(){super.render(),(0,l.submitHandler)({view:this})}focus(){this.childViewsCollection.first.focus()}_createInput(e,t={}){const o=new l.LabeledFieldView(this.locale,l.createLabeledInputText);return o.label=e,t.required&&!0===t.required&&o.fieldView.extendTemplate({attributes:{required:!0}}),o}_createButton(e,t,o){const i=new l.ButtonView;return i.set({label:e,icon:t,tooltip:!0,class:o}),i}}class d extends e.Plugin{static get requires(){return[l.ContextualBalloon]}init(){this._balloon=this.editor.plugins.get(l.ContextualBalloon),this._addToolbarButton(),this.formView=this._createFormView(),this._handleSelection()}_addToolbarButton(){const e=this.editor;e.ui.componentFactory.add("demoLink",(t=>{const o=new l.ButtonView(t);o.set({label:e.t("demoLink"),icon:'<?xml version="1.0" encoding="UTF-8"?>\n<svg xmlns="http://www.w3.org/2000/svg" id="Outline" viewBox="0 0 24 24" width="512" height="512"><path d="M20.137,24a2.8,2.8,0,0,1-1.987-.835L12,17.051,5.85,23.169a2.8,2.8,0,0,1-3.095.609A2.8,2.8,0,0,1,1,21.154V5A5,5,0,0,1,6,0H18a5,5,0,0,1,5,5V21.154a2.8,2.8,0,0,1-1.751,2.624A2.867,2.867,0,0,1,20.137,24ZM6,2A3,3,0,0,0,3,5V21.154a.843.843,0,0,0,1.437.6h0L11.3,14.933a1,1,0,0,1,1.41,0l6.855,6.819a.843.843,0,0,0,1.437-.6V5a3,3,0,0,0-3-3Z"/></svg>\n',tooltip:!0});const i=e.commands.get("demoLink");return o.bind("isEnabled").to(i,"isEnabled"),o.bind("isOn").to(i,"value",(e=>!!e)),this.listenTo(o,"execute",(()=>this._showUI())),o}))}_createFormView(){const e=new s(this.editor.locale);return this.listenTo(e,"submit",(()=>{let t={demoLinkText:e.textInputView.fieldView.element.value,demoLinkUrl:e.urlInputView.fieldView.element.value,demoBackgroundColor:e.backgroundColor.fieldView.element.value,demoTextColor:e.textInputColor.fieldView.element.value};this.editor.execute("demoLink",t),this._hideUI()})),this.listenTo(e,"cancel",(()=>{this._hideUI()})),(0,l.clickOutsideHandler)({emitter:e,activator:()=>this._balloon.visibleView===e,contextElements:[this._balloon.view.element],callback:()=>this._hideUI()}),e}_addFormView(){this._balloon.add({view:this.formView,position:this._getBalloonPositionData()});const e=this.editor.commands.get("demoLink");Object.entries({demoLinkText:"textInputView",demoLinkUrl:"urlInputView",demoBackgroundColor:"backgroundColor",demoTextColor:"textInputColor"}).forEach((([t,o])=>{const i=this.formView[o];i.focus();const n=this.editor.config,r=n._config.colors_config.background_color,l=n._config.colors_config.color,s=!e.value||!e.value[t]||""===e.value[t];return"demoLinkUrl"===t&&s?(i.fieldView.element.value="#",void i.set("isEmpty",!1)):"demoBackgroundColor"===t&&s?(i.fieldView.element.value=r,void i.set("isEmpty",!1)):"demoTextColor"===t&&s?(i.fieldView.element.value=l,void i.set("isEmpty",!1)):(s||(i.fieldView.element.value=e.value[t]),void i.set("isEmpty",s))})),this.formView.focus()}_handleSelection(){const e=this.editor;this.listenTo(e.editing.view.document,"selectionChange",((t,o)=>{const i=e.model.document.selection;let n=i.getSelectedElement()??i.getFirstRange().getCommonAncestor();if(!["demoLinkText"].includes(n.name))return void this._hideUI();this._showUI();const r=e.model.createPositionBefore(n),l=e.model.createPositionAfter(n),s=i.getFirstPosition(),d="demoLinkText"==n.name&&s.isTouching(r),c="demoLinkText"==n.name&&s.isTouching(l);(d||c)&&e.model.change((e=>{e.setSelection(n.findAncestor("demoLink"),"on")}))}))}_showUI(){this._addFormView()}_hideUI(){const e=this.formView;e.element&&e.element.reset(),this._balloon.hasView(e)&&this._balloon.remove(e),this.editor.editing.view.focus()}_getBalloonPositionData(){const e=this.editor.editing.view,t=e.document;let o=null;return o=()=>e.domConverter.viewRangeToDom(t.selection.getFirstRange()),{target:o}}}class c extends e.Plugin{static get requires(){return[r,d]}static get pluginName(){return"demoLink"}}const a={DemoLink:c}})(),i=i.default})()));